{
  "hash": "7fb9279b47ef2a231aa4b11466e9f834",
  "result": {
    "markdown": "---\ntitle: Bay Area Insects\ndescription: --Insect Species Occurance Data Visualization\nauthor: RJ Cody Markelz\ndate: 2022-05-15\ncategories: [species distribution, modeling, GIS, maps, explore, GBIF, data visualization]\nimage: /images/bay_area_insects.png\n---\n\n\n\n\nI am working on a project using data collected at some of the UC Reserves. I needed to see what observations of insects were available in GBIF. \n\nI found this [drawing tool](https://boundingbox.klokantech.com/) for bounding boxes. Make sure to export it as OGC WKT and then you can create a POLYGON to use as your query area.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nreserve_geometry <- paste('POLYGON((-121.383275382 35.7567710044, -121.9875234289 36.3607073262, -122.525853507 37.2841110386, -123.1520742101 38.0753438834, -123.7123769445 38.8153202525, -123.8332265539 39.0972469563, -123.4596913976 39.2930774901, -122.0644277258 39.2250244313, -121.7568105383 38.0320888877, -121.4052480383 37.2578829342, -121.119603507 36.7402099684, -120.9987538976 36.1303379589, -121.383275382 35.7567710044))')\n```\n:::\n\n\nLoad the libraries.\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(rgbif)\nlibrary(tidyverse)\nlibrary(maps)\n```\n:::\n\n\nQuery the greater Bay Area for insects using the classKey for *Insecta* using the above geometry. Make a new dataframe with only the data from the query for plotting and data manipulation.\n\n::: {.cell}\n\n```{.r .cell-code}\ninsect <- occ_data(classKey = 216, hasCoordinate = TRUE, limit = 1000, geometry = reserve_geometry)\ninsect_coords <- insect$data\nhead(insect_coords)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 78\n  key     scien…¹ decim…² decim…³ issues datas…⁴ publi…⁵ insta…⁶ publi…⁷ proto…⁸\n  <chr>   <chr>     <dbl>   <dbl> <chr>  <chr>   <chr>   <chr>   <chr>   <chr>  \n1 401151… Dishol…    37.5   -122. cdc,c… 50c950… 28eb1a… 997448… US      DWC_AR…\n2 401150… Dishol…    37.5   -122. cdc,c… 50c950… 28eb1a… 997448… US      DWC_AR…\n3 401170… Forfic…    37.5   -122. cdc,c… 50c950… 28eb1a… 997448… US      DWC_AR…\n4 401164… Danaus…    37.5   -122. cdc,c… 50c950… 28eb1a… 997448… US      DWC_AR…\n5 401182… Aphis …    37.3   -122. cdc,c… 50c950… 28eb1a… 997448… US      DWC_AR…\n6 401189… Vaness…    37.0   -122. cdc    50c950… 28eb1a… 997448… US      DWC_AR…\n# … with 68 more variables: lastCrawled <chr>, lastParsed <chr>, crawlId <int>,\n#   hostingOrganizationKey <chr>, basisOfRecord <chr>, occurrenceStatus <chr>,\n#   taxonKey <int>, kingdomKey <int>, phylumKey <int>, classKey <int>,\n#   orderKey <int>, familyKey <int>, genusKey <int>, speciesKey <int>,\n#   acceptedTaxonKey <int>, acceptedScientificName <chr>, kingdom <chr>,\n#   phylum <chr>, order <chr>, family <chr>, genus <chr>, species <chr>,\n#   genericName <chr>, specificEpithet <chr>, taxonRank <chr>, …\n```\n:::\n:::\n\n\nVisualize the data for the state of California.\n\n::: {.cell}\n\n```{.r .cell-code}\nmaps::map(database = \"state\", region = \"california\")\npoints(insect_coords[ , c(\"decimalLongitude\", \"decimalLatitude\")], pch = \".\", col = \"blue\", cex = 3)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nRandomly subset the coordinates dataframe and plot species by color. If you have a large screen, you can make a larger plotting window with many more species than 25.\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(25344)\ninsect_coords_25 <- sample_n(insect_coords, 25)\nspecies_plot1  <- ggplot(insect_coords_25, aes(x=decimalLongitude, y = decimalLatitude, color =acceptedScientificName)) +\n       geom_point() + labs(x = \"Longitude\", y = \"Latitude\", color = \"Species\", title = \"Bay Area Insect Distributions\")\nspecies_plot1\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggsave(\"~/DATA/images/bay_area_insects.png\")\n```\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}