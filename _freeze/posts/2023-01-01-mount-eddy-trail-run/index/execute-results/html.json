{
  "hash": "c91276397f5defba933f575dffce78ff",
  "result": {
    "markdown": "---\ntitle: Mount Eddy Trail Run \ndescription: --Foxtail Pines Revisited\nauthor: RJ Cody Markelz\ndate: 2023-01-01\ncategories: [species distribution, modeling, GIS, maps, data, trail run, exercise, explore, illustration]\nimage: /images/foxtail-pinecone-web.png\n---\n\n\n\n<img src=\"/images/foxtail-pinecone-web.png\" alt=\"Foxtail Pine Cone Illustration\" height=\"600\"/>\nFoxtail Pine Cone Illustration\n\n# Introduction\nMy partner and I recently revisited one the conifer species that occur in the [Miracle Mile](/posts/2021-06-17-gbif-miracle-mile-species/index.html), but by trail running up to the top of [Mount Eddy](https://en.wikipedia.org/wiki/Mount_Eddy) (9,037 ft; 2,754 m) in the Klamath Range. The final sub-alpine zone near the top of the mountain is a large grove of Foxtail Pine (*Pinus balfouriana*). I paid another visit to that same grove in another [recent post](/posts/2022-04-01-foxtailpinetrailrun/index.html), but did not go up to the higher elevations above 8000 ft.\n\nLoad the libraries.\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(gpx)\nlibrary(rayshader)\nlibrary(rgbif)\nlibrary(data.table)\nlibrary(maps)\n```\n:::\n\n\nIn-file the trail run gps data and make a data frame to use for plotting.\n\n::: {.cell}\n\n```{.r .cell-code}\nrun <-  read_gpx('~/DATA/data/mount_eddy_trail_run.gpx')\nsummary(run)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          Length Class  Mode\nroutes    1      -none- list\ntracks    1      -none- list\nwaypoints 1      -none- list\n```\n:::\n\n```{.r .cell-code}\nTrailRun1 <- as.data.frame(run$routes)\nTrailRun1$Time <- as.numeric(row.names(TrailRun1))\n```\n:::\n\n\nMake a quick plot using the latitude and longitude coordinates.\n\n::: {.cell}\n\n```{.r .cell-code}\nTR_p1 <- ggplot() +\n          geom_point(data = TrailRun1, aes(x = Longitude, y = Latitude), color = 'black', size = 2) +\n          xlab(\"Longitude\") + ylab(\"Latitude\")\nTR_p1\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\nTake a look at the elevation profile of the run.\n\n::: {.cell}\n\n```{.r .cell-code}\nTR_p2 <- ggplot() +\n          geom_line(data = TrailRun1, aes(x = Time, y = Elevation), color = 'black', size = 2) +\n          xlab(\"Time (seconds)\") + ylab(\"Elevation (m)\")\nTR_p2\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\nWe can also plot the run and false color it based on the elevation. We can pass this plot to the plot_gg() function in the rayshader package to make a 3D plot of the run. The code for that is not run on the website because it takes too long to render, so I am showing the rendered snapshot as an external image instead.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nTR_p3 <- ggplot() +\n          geom_point(data = TrailRun1, aes(x = Longitude, y = Latitude, color = Elevation), size = 2) +\n          scale_color_continuous(limits=c(800,2800))\nTR_p3\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Not run for website rendering purposes, but you should!\n# plot_gg(TR_p3, width = 15, height = 15, multicore = TRUE, scale = 1000,\n#         zoom = .7, theta = 10, phi = 20, windowsize = c(3000, 3000))\n# Sys.sleep(0.2)\n# render_snapshot(filename = \"mt-eddy-run-elevation-plot3.png\", clear = TRUE)\n```\n:::\n\n<img src=\"/images/mount-eddy-trail-run-profile.png\" alt=\"trail run elevation profile\" height=\"600\"/>\n\n\nUsing the Latitude and Longitude coordinates of the area we can make a general area polygon to be used for a GBIF species observation query to the public database.\n\n::: {.cell}\n\n```{.r .cell-code}\nnorcal_geometry <- paste('POLYGON((-122.6 41.35, -122.6 41.25, -122.4 41.25, -122.35 41.25, -122.35 41.35, -122.6 41.35))')\n\nmm_species <- c(\"pinus balfouriana\") # can add multiple species here for larger query\n\nfoxtail_data <- occ_data(scientificName = mm_species, hasCoordinate = TRUE, limit = 10000,\n                   geometry = norcal_geometry)\nfoxtail_data\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRecords found [74] \nRecords returned [74] \nArgs [hasCoordinate=TRUE, occurrenceStatus=PRESENT, limit=10000, offset=0,\n     scientificName=pinus balfouriana, geometry=POLYGON((-122.6 41.35, -122.6\n     41.25, -122.4 41.25, -122.35 41.25, -122.35 41.35, -122.6 41.35))] \n# A tibble: 74 × 124\n   key    scien…¹ decim…² decim…³ issues datas…⁴ publi…⁵ insta…⁶ hosti…⁷ publi…⁸\n   <chr>  <chr>     <dbl>   <dbl> <chr>  <chr>   <chr>   <chr>   <chr>   <chr>  \n 1 41657… Pinus …    41.3   -122. cdc,c… 50c950… 28eb1a… 997448… 28eb1a… US     \n 2 41657… Pinus …    41.3   -122. cdc,c… 50c950… 28eb1a… 997448… 28eb1a… US     \n 3 44002… Pinus …    41.3   -122. cdc,c… 50c950… 28eb1a… 997448… 28eb1a… US     \n 4 43998… Pinus …    41.3   -122. cdc,c… 50c950… 28eb1a… 997448… 28eb1a… US     \n 5 44000… Pinus …    41.3   -122. cdc,c… 50c950… 28eb1a… 997448… 28eb1a… US     \n 6 44001… Pinus …    41.3   -122. cdc,c… 50c950… 28eb1a… 997448… 28eb1a… US     \n 7 43999… Pinus …    41.3   -122. cdc,c… 50c950… 28eb1a… 997448… 28eb1a… US     \n 8 44004… Pinus …    41.3   -122. cdc    50c950… 28eb1a… 997448… 28eb1a… US     \n 9 44049… Pinus …    41.3   -122. cdc,c… 50c950… 28eb1a… 997448… 28eb1a… US     \n10 44363… Pinus …    41.3   -122. cdc,c… 50c950… 28eb1a… 997448… 28eb1a… US     \n# … with 64 more rows, 114 more variables: protocol <chr>, lastCrawled <chr>,\n#   lastParsed <chr>, crawlId <int>, basisOfRecord <chr>,\n#   occurrenceStatus <chr>, taxonKey <int>, kingdomKey <int>, phylumKey <int>,\n#   classKey <int>, orderKey <int>, familyKey <int>, genusKey <int>,\n#   speciesKey <int>, acceptedTaxonKey <int>, acceptedScientificName <chr>,\n#   kingdom <chr>, phylum <chr>, order <chr>, family <chr>, genus <chr>,\n#   species <chr>, genericName <chr>, specificEpithet <chr>, taxonRank <chr>, …\n```\n:::\n\n```{.r .cell-code}\nfoxtail_coords <- foxtail_data$data[ , c(\"decimalLongitude\", \"decimalLatitude\",\n \"individualCount\", \"occurrenceStatus\", \"coordinateUncertaintyInMeters\",\n  \"institutionCode\", \"references\")]\n```\n:::\n\n\nPlot the observations on the California map to see the limited polygon sampled.\n\n::: {.cell}\n\n```{.r .cell-code}\nmaps::map(database = \"state\", region = \"california\")\npoints(foxtail_coords[ , c(\"decimalLongitude\", \"decimalLatitude\")], pch = \".\", col = \"red\", cex = 3)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nPlot all of the observations using ggplot for the zoomed in area.\n\n::: {.cell}\n\n```{.r .cell-code}\nfoxtail_plot1  <- ggplot(foxtail_coords, aes(x=decimalLongitude, y = decimalLatitude)) +\n                             geom_point(color='red') + labs(title = \"MM Zone\")\nfoxtail_plot1\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\nCombine trail running and foxtail pine occurrence observations.\n\n::: {.cell}\n\n```{.r .cell-code}\nrun_plot2 <- ggplot() +\n          coord_quickmap() +\n          geom_point(data = TrailRun1, aes(x = Longitude, y = Latitude), color = 'black') +\n          geom_point(data=foxtail_coords, aes(x = decimalLongitude, y = decimalLatitude), color = 'red') +\n          xlab(\"Longitude\") + ylab(\"Latitude\")\nrun_plot2\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}