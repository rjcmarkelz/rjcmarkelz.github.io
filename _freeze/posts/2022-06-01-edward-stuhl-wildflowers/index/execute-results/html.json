{
  "hash": "1f660c53f97520a0cf2646a8db96b5b4",
  "result": {
    "markdown": "---\ntitle: Edward Stuhl Wildflowers\ndescription: --Mount Shasta Wildflowers GBIF data\nauthor: RJ Cody Markelz\ncategories: [data, scraping, web, extraction, meta-data, water color, wildflowers, plants, mount shasta, stuhl]\ndate: 2022-06-01\nimage: /images/stuhl_species.png\n---\n\n\n\nI have been working on identifying and painting various local wildflowers from the book [Mount Shasta Wild Flowers A Field Guide](http://dev.mountshastawildflowers.com/) featuring the water color paintings of Edward Stuhl. Stuhl was an artist and mountaineer that gradually painted 189 plants over a 50 year career exploring the greater Mount Shasta area. All of his paintings are available to view online at CSU Chico [here](http://archives.csuchico.edu/digital/collection/coll5). I was interested in what sort of publicly available observation data there was for some of the more rare species. I downloaded the\n[original list here](http://dev.mountshastawildflowers.com/about-the-book/mount-shasta-plant-list/), and made a few quick formatting edits to get it ready to pull into R.\n\nLoad the libraries.\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(readxl)\nlibrary(rgbif)\nlibrary(data.table)\n```\n:::\n\n\nPull in the data, take a quick look, and make a character vector of the species names for the GBIF query.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nshasta_plants <- read_excel(\"~/DATA/data/mount.shasta.plant.list.edit.xlsx\")\n\nhead(shasta_plants)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 Ã— 5\n  ID           Family           Genus       species    `subspecies or variety`\n  <chr>        <chr>            <chr>       <chr>      <chr>                  \n1 Ferns_Allies Dennstaedtiaceae Pteridium   aquilinum  var. pubescens         \n2 Ferns_Allies Dryopteridaceae  Polystichum scopulinum <NA>                   \n3 Ferns_Allies Equisetaceae     Equisetum   arvense    <NA>                   \n4 Ferns_Allies Equisetaceae     Equisetum   hyemale    ssp. affine            \n5 Ferns_Allies Ophioglossaceae  Botrychium  pinnatum   <NA>                   \n6 Ferns_Allies Ophioglossaceae  Botrychium  pumicola   <NA>                   \n```\n:::\n\n```{.r .cell-code}\ndim(shasta_plants)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 482   5\n```\n:::\n\n```{.r .cell-code}\nshasta_plants$query <- as.character(paste(shasta_plants$Genus, shasta_plants$species))\nshasta_species <- shasta_plants$query\nhead(shasta_species)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Pteridium aquilinum\"    \"Polystichum scopulinum\" \"Equisetum arvense\"     \n[4] \"Equisetum hyemale\"      \"Botrychium pinnatum\"    \"Botrychium pumicola\"   \n```\n:::\n:::\n\n\nMake a polygon to query from within and run a GBIF query iterating through the shasta_species character vector. The query takes a while for building this webpage, so I am going to just load the result instead to list the objects. If you want to run the query uncomment the following few lines.\n\n::: {.cell}\n\n```{.r .cell-code}\nmt_shasta_geometry <- paste('POLYGON((-122.600528 41.551515, -122.001773 41.551515, -122.001773 41.252791, -122.600528 41.252791, -122.600528 41.551515))')\n\n# shasta_all <- occ_data(scientificName = shasta_species, hasCoordinate = TRUE, limit = 100,\n#                   geometry = mt_shasta_geometry)\n\nload(\"~/DATA/data/Stuhl_Shasta_species_GBIF.RData\")\nls()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"mt_shasta_geometry\" \"shasta_all\"         \"shasta_plants\"     \n[4] \"shasta_species\"    \n```\n:::\n:::\n\n\nIterate through the GBIF query list and pull out the latitude and longitude of each observation and bind them all together.\n\n::: {.cell}\n\n```{.r .cell-code}\nshasta_species_coords_list <- vector(\"list\", length(shasta_species))\nnames(shasta_species_coords_list) <- shasta_species\n\nfor (x in shasta_species) {\n  coords <- shasta_all[[x]]$data[ , c(\"decimalLongitude\", \"decimalLatitude\", \"occurrenceStatus\")]\n  shasta_species_coords_list[[x]] <- data.frame(cbind(species = x, coords))\n}\n\nspecies_coord_df <- rbindlist(shasta_species_coords_list, fill = T)\nhead(species_coord_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n               species decimalLongitude decimalLatitude occurrenceStatus\n1: Pteridium aquilinum        -122.3233        41.28727          PRESENT\n2: Pteridium aquilinum        -122.3304        41.31041          PRESENT\n3: Pteridium aquilinum        -122.0664        41.27251          PRESENT\n4: Pteridium aquilinum        -122.0780        41.28300          PRESENT\n5: Pteridium aquilinum        -122.3066        41.27987          PRESENT\n6: Pteridium aquilinum        -122.4471        41.44342          PRESENT\n```\n:::\n:::\n\n\nMake a quick plot of the data removing the legend or it will overwhelm the plot with the large number of species.\n\n::: {.cell}\n\n```{.r .cell-code}\nspecies_p1  <- ggplot(species_coord_df, aes(x=decimalLongitude, y = decimalLatitude, color = species)) +\n                geom_point() +\n                labs(x = \"Longitude\", y = \"Latitude\", title = \"Mount Shasta Plant Species Observations\") + theme(legend.position=\"none\")\nspecies_p1\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggsave(\"~/DATA/images/stuhl_species.png\")\n```\n:::\n\n\nA lifetime of exploration just in my general area! I hope to share more paintings of the same species as I am out and about around Mount Shasta.\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}